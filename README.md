## 선착순 쿠폰 발급 시스템

> 대규모 트래픽에서도 안정적이고 빠르게 쿠폰을 발급하기 위한 시스템입니다.  
> Redis 기반의 비동기 처리와 캐시 시스템을 활용하여 대량의 요청을 효율적으로 처리하고 데이터의 일관성을 보장합니다.

## 개발 환경
Java 11+
Spring Boot
Redis (List, Set, Lua Script)
Lombok
MySQL
Docker

## 기능
선착순으로 쿠폰 기능을 발급합니다.

## 흐름
1. 사용자가 쿠폰 발급 요청 (API)
   │
   ▼
2. Redis 큐에 발급 요청 추가
   │
   ▼
3. Redis 큐에 발급 요청 대기
   │
   ▼
4. 1초마다 Redis 큐에서 요청 가져오기
   │
   ▼
5. 쿠폰 발급 비즈니스 로직 실행
   │
   ▼
6. DB에 발급 정보 저장 및 발급 완료 이벤트 발행
   │
   ▼
7. 트랜잭션 커밋 후 캐시 갱신
   │
   ▼
8. Redis Cache 및 Local Cache에 최신 쿠폰 상태 저장


## 트러블슈팅
mysql을 사용하여 lock을 사용했지 동시성 요청이 많을 경우 병목 현상이 발생하고 300개의 쿠폰 발급 요청에 대해 300개 이상이 발급되는 현상이 발생.
 -> DB 락을 사용했지만 요청이 급증할 때 DB 트랜잭션 처리 속도가 느려 동시성 문제가 발생.
   --> Redis 기반의 분산 락 및 Lua 스크립트를 활용하여 문제 해결
   Redis Cache만 사용했을 때도 성능이 좋았지만, 동시성 요청이 많거나 빈번한 데이터 조회가 필요한 상황에서는 Redis로 인한 네트워크 지연이 발생.
   로컬 캐시(Local Cache)를 추가로 도입하여 조회 속도 향상
